@{
    ViewData["Title"] = "Đi chợ giùm bạn";
    Layout = "~/Views/Shared/_Layout.cshtml";
    List<SharedObjects.ValueObjects.VProduct> allProduct = ViewBag.AllProducts;
    var categories = ViewBag.categories as List<SharedObjects.ValueObjects.VProductCategory>;
}
@model SharedObjects.ViewModels.HomeViewModel;


<!-- SLIDER AREA START (slider-3) -->
<div class="ltn__slider-area ltn__slider-3---  section-bg-1--- mt-15">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <!-- CATEGORY-MENU-LIST START -->
                <div class="ltn__category-menu-wrap">
                    <div class="ltn__category-menu-title">
                        <h2 class="section-bg-2--- ltn__secondary-bg text-color-white">Danh mục</h2>
                    </div>
                    <div class="ltn__category-menu-toggle ltn__one-line-active">
                        <ul>
                            <!-- Submenu Column - unlimited -->
                            @foreach (var item in categories.Select(x => x.CatName).Distinct())
                            {
                                var child = categories.Where(x => x.CatName == item);
                                <li class="ltn__category-menu-item ltn__category-menu-drop">
                                    <a href="#"><i class="icon-tag"></i>@item</a>
                                    <ul class="ltn__category-submenu">

                                        @foreach (var p in child)
                                        {
                                            <li><a asp-action="Detail" asp-controller="Product" asp-route-productId="@p.ProductID">@p.ProductName</a></li>
                                        }
                                    </ul>
                                </li>
                            }
                        </ul>
                    </div>
                </div>
                <!-- END CATEGORY-MENU-LIST -->
            </div>
            <div class="col-lg-9">
                <div class="ltn__slide-active-2 slick-slide-arrow-1 slick-slide-dots-1">
                    <!-- ltn__slide-item -->
                    <div class="ltn__slide-item ltn__slide-item-10 section-bg-1 bg-image" data-bg="img/slider/61.jpeg">
                        <div class="ltn__slide-item-inner">
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-7 col-md-7 col-sm-7 align-self-center">
                                        <div class="slide-item-info">
                                            <div class="slide-item-info-inner ltn__slide-animation">
                                                <h5 class="slide-sub-title ltn__secondary-color animated text-uppercase">Giảm giá 15% giá trị đơn hàng!</h5>
                                                <h1 class="slide-title  animated">Quét mã VNPAY<br>Nhận ngay ưu đãi</h1>
                                                <div class="slide-brief animated d-none">
                                                    <p>Predictive analytics is drastically changing the real estate industry. In the past, providing data for quick</p>
                                                </div>
                                                <div class="btn-wrapper  animated">
                                                    <a asp-action="Index" asp-controller="Product" class="theme-btn-1 btn btn-effect-1 text-uppercase">Mua ngay</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-5 col-md-5 col-sm-5 align-self-center">
                                        <div class="slide-item-img">
                                            <!-- <a href="shop.html"><img src="~/img/product/1.png" alt="Image"></a> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ltn__slide-item -->
                    <div class="ltn__slide-item ltn__slide-item-10 section-bg-1 bg-image" data-bg="img/slider/62.jpeg">
                        <div class="ltn__slide-item-inner">
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-7 col-md-7 col-sm-7 align-self-center">
                                        <div class="slide-item-info">
                                            <div class="slide-item-info-inner ltn__slide-animation">
                                                <h5 class="slide-sub-title ltn__secondary-color animated text-uppercase">Giảm giá cực sốc!</h5>
                                                <h3 class="slide-title  animated">Tươi ngon mỗi ngày</h3>
                                                <div class="slide-brief animated d-none">
                                                    <p>Predictive analytics is drastically changing the real estate industry. In the past, providing data for quick</p>
                                                </div>
                                                <div class="btn-wrapper  animated">
                                                    <a asp-action="Index" asp-controller="Product" class="theme-btn-1 btn btn-effect-1 text-uppercase">Mua ngay</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-5 col-md-5 col-sm-5 align-self-center">
                                        <div class="slide-item-img">
                                            <!-- <a href="shop.html"><img src="~/img/slider/62.jpg" alt="Image"></a> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- SLIDER AREA END -->
<!-- BLOG AREA START (blog-3) -->
<div class="ltn__blog-area pt-20 pb-15">
    <div class="container">
        <div class="row  ltn__blog-slider-one-active slick-arrow-1 ltn__blog-item-3-normal">
            @foreach (var item in Model.News)
            {
                string url = $"{HostConfig.Domain}/images/new/{item.Thumb}";
                <!-- Blog Item -->
                <div class="col-lg-12">
                    <div class="ltn__blog-item ltn__blog-item-3">
                        <div class="ltn__blog-img">
                            <a asp-controller="New" asp-action="Detail" asp-route-id="@item.PostId"><img width="400" height="260" src="@url" alt="#"></a>
                        </div>
                        <div class="product-badge">
                            <ul>
                                <li class="sale-badge">Bài đăng mới</li>
                            </ul>
                        </div>
                        <div class="ltn__blog-brief">
                            <div class="ltn__blog-meta">
                                <ul>
                                    <li class="ltn__blog-author">
                                        <a href="#"><i class="far fa-user"></i>Tác giả: @item.UserName</a>
                                    </li>
                                    <li class="ltn__blog-tags">
                                        <a href="#"><i class="fas fa-tags"></i>Tag</a>
                                    </li>
                                </ul>
                            </div>
                            <h3 class="ltn__blog-title"><a asp-controller="New" asp-action="Detail" asp-route-id="@item.PostId">@item.Title</a></h3>
                            <div class="ltn__blog-meta-btn">
                                <div class="ltn__blog-meta">
                                    <ul>
                                        <li class="ltn__blog-date"><i class="far fa-calendar-alt"></i>@item.CreatedDate.ToString("dd/MM/yyyy")</li>
                                    </ul>
                                </div>
                                <div class="ltn__blog-btn">
                                    <a asp-controller="New" asp-action="Detail" asp-route-id="@item.PostId">Đọc thêm</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Blog Item -->
            }
        </div>
    </div>
</div>
<!-- BLOG AREA END -->
<!-- PRODUCT TAB AREA START (product-item-3) -->
<div class="ltn__product-tab-area ltn__product-gutter pt-20 pb-15">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title-area ltn__section-title-2--- text-center">
                    <!-- <h6 class="section-subtitle ltn__secondary-color">// Cars</h6> -->
                    <h1 class="section-title">Sản phẩm</h1>
                </div>
                <div class="ltn__tab-menu ltn__tab-menu-2 ltn__tab-menu-top-right-- text-uppercase text-center">
                    <div class="nav">
                        <a class="active show" data-toggle="tab" href="#all-items">Tất cả sản phẩm</a>
                        @foreach (var item in Model.Products)
                        {
                            <a data-toggle="tab" href="#@item.category.Alias">@item.category.CatName</a>
                        }
                    </div>
                </div>
                <div class="tab-content">
                    <div class="tab-pane fade active show" id="all-items">
                        @await Html.PartialAsync("_ListProductPartialView", allProduct)
                    </div>
                    @foreach (var item in Model.Products)
                    {
                        <div class="tab-pane fade" id="@item.category.Alias">
                            @await Html.PartialAsync("_ListProductPartialView", item.lsProducts)
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
<!-- PRODUCT TAB AREA END -->
<!-- FEATURE AREA START ( Feature - 3) -->
<div class="ltn__feature-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="ltn__feature-item-box-wrap ltn__feature-item-box-wrap-2 ltn__border section-bg-6">
                    <div class="ltn__feature-item ltn__feature-item-8">
                        <div class="ltn__feature-icon">
                            <img src="~/img/icons/svg/8-trolley.svg" alt="#">
                        </div>
                        <div class="ltn__feature-info">
                            <h4>Giao hàng</h4>
                            <p>Toàn bộ khu vực Cần Thơ</p>
                        </div>
                    </div>
                    <div class="ltn__feature-item ltn__feature-item-8">
                        <div class="ltn__feature-icon">
                            <img src="~/img/icons/svg/9-money.svg" alt="#">
                        </div>
                        <div class="ltn__feature-info">
                            <h4>Giá cả</h4>
                            <p>Hợp lý</p>
                        </div>
                    </div>
                    <div class="ltn__feature-item ltn__feature-item-8">
                        <div class="ltn__feature-icon">
                            <img src="~/img/icons/svg/10-credit-card.svg" alt="#">
                        </div>
                        <div class="ltn__feature-info">
                            <h4>Bảo mật</h4>
                            <p>Thanh toán đơn giản</p>
                        </div>
                    </div>
                    <div class="ltn__feature-item ltn__feature-item-8">
                        <div class="ltn__feature-icon">
                            <img src="~/img/icons/svg/11-gift-card.svg" alt="#">
                        </div>
                        <div class="ltn__feature-info">
                            <h4>Ưu đãi</h4>
                            <p>Mỗi cuối tuần</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- FEATURE AREA END -->
<!-- CALL TO ACTION START (call-to-action-2) -->
<div class="ltn__call-to-action-area call-to-action-2 pt-20 pb-20" data-bg="img/1.jpg--">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="call-to-action-inner call-to-action-inner-2 text-center">
                    <h2>Liên hệ với chúng tôi</h2>
                    <div class="btn-wrapper">
                        <a class="btn btn-effect-4 btn-white" asp-action="Contact" asp-controller="Home"><i class="fas fa-phone-volume"></i> Liên hệ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- CALL TO ACTION END -->
<!-- BANNER AREA START -->
<div class="ltn__banner-area">
    <div class="container">
        <div class="row ltn__custom-gutter--- justify-content-center">
            <div class="col-lg-4 col-md-6">
                <div class="ltn__banner-item">
                    <div class="ltn__banner-img">
                        <a asp-controller="Product" asp-action="Index"><img src="~/img/banner/1.jpeg" alt="Banner Image"></a>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="ltn__banner-item">
                    <div class="ltn__banner-img">
                        <a asp-controller="Product" asp-action="Index"><img src="~/img/banner/2.jpeg" alt="Banner Image"></a>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="ltn__banner-item">
                    <div class="ltn__banner-img">
                        <a asp-controller="Product" asp-action="Index"><img src="~/img/banner/1.jpeg" alt="Banner Image"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- BANNER AREA END -->
<!-- BRAND LOGO AREA START -->
<div class="ltn__brand-logo-area ltn__brand-logo-1 section-bg-1 pt-110 pb-110 plr--9 d-none">
    <div class="container-fluid">
        <div class="row ltn__brand-logo-active">
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/1.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/2.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/3.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/4.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/5.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/3.png" alt="Brand Logo">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- BRAND LOGO AREA END -->
<!-- COUNTDOWN AREA START -->
<div class="ltn__call-to-action-area ltn__call-to-action-4 ltn__call-to-action-4-2 bg-overlay-black-50 bg-image pt-110 pb-120 d-none" data-bg="img/bg/6.jpg">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="call-to-action-inner call-to-action-inner-4 text-color-white text-center">
                    <h2 class="ltn__secondary-color">Hurry Up!</h2>
                    <h1 class="h1">Hot Deal! Sale Up To 20% off</h1>
                    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. <br> Explicabo id, unde hic molestias omnis.</p>
                    <div class="ltn__countdown ltn__countdown-3 bg-white--" data-countdown="2021/12/28"></div>
                    <div class="btn-wrapper animated">
                        <a asp-action="Index" asp-controller="Product" class="theme-btn-1 btn btn-effect-1 text-uppercase">Mua ngay</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="ltn__call-to-4-img-1">
        <img src="~/img/product/7.png" alt="#">
    </div>
    <div class="ltn__call-to-4-img-2">
        <img src="~/img/bg/11.png" alt="#">
    </div>
</div>
<!-- COUNTDOWN AREA END -->
<!-- BRAND LOGO AREA START -->
<div class="ltn__brand-logo-area ltn__brand-logo-1 section-bg-6 border-top pt-35 pb-35 plr--9">
    <div class="container-fluid">
        <div class="row ltn__brand-logo-active">
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/1.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/2.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/3.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/4.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/5.png" alt="Brand Logo">
                </div>
            </div>
            <div class="col-lg-12">
                <div class="ltn__brand-logo-item">
                    <img src="~/img/brand-logo/3.png" alt="Brand Logo">
                </div>
            </div>
        </div>
    </div>
</div>
@section Script{
    <script>
        $('body').off('click', '.view').on('click', '.view', GetById);
        function GetById() {
            var tranferId = $(this).data('id');
            $.ajax({
                type: 'post',
                url: '/Product/GetById',
                dataType: 'json',
                data: { productId: tranferId },
                success: function (response) {
                    var data = response.result;
                    $('#txt-Avatar').attr("src", data.avatar);
                    $('#hid-id').text(data.productId);
                    $('#txt-ProductName').text(data.productName);
                    $('#txt-Price').text(data.price.toLocaleString('it-IT', { style: 'currency', currency: 'VNĐ' }));
                    $('#txt-CatName').text(data.catName);
                }
            })
        }</script>
}